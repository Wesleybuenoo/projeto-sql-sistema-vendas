USE sistema_vendas;

-- Listar todos os clientes
SELECT * FROM clientes;

-- Produtos com estoque baixo
SELECT * FROM produtos WHERE estoque < 20;

-- Pedidos com nome do cliente
SELECT p.id AS pedido_id, c.nome AS cliente, p.data_pedido
FROM pedidos p
JOIN clientes c ON c.id = p.cliente_id;

-- Total gasto por cliente
SELECT 
    c.nome AS cliente,
    SUM(i.quantidade * i.preco_unitario) AS total_gasto
FROM clientes c
JOIN pedidos p ON p.cliente_id = c.id
JOIN itens_pedido i ON i.pedido_id = p.id
GROUP BY c.id;

-- Produto mais vendido
SELECT 
    pr.nome,
    SUM(i.quantidade) AS total_vendido
FROM itens_pedido i
JOIN produtos pr ON pr.id = i.produto_id
GROUP BY pr.id
ORDER BY total_vendido DESC
LIMIT 1;
